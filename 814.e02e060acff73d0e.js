"use strict";(self.webpackChunkshop_web=self.webpackChunkshop_web||[]).push([[814],{814:(M,c,a)=>{a.r(c),a.d(c,{CheckoutComponent:()=>_});var l=a(2881),d=a(4341),e=a(1360),u=a(6868),p=a(4796),m=a(8674),g=a(9315);function h(i,C){if(1&i&&(e.j41(0,"div",10),e.nrm(1,"img",11),e.j41(2,"div")(3,"p"),e.EFF(4),e.k0s(),e.j41(5,"small"),e.EFF(6),e.k0s()(),e.j41(7,"b"),e.EFF(8),e.k0s()()),2&i){const o=C.$implicit;e.R7$(),e.Y8G("src",o.product.imageUrl,e.B4B),e.R7$(3),e.JRh(o.product.name),e.R7$(2),e.SpI("Qty: ",o.quantity,""),e.R7$(2),e.SpI("\u20ac",o.price*o.quantity,"")}}let _=(()=>{class i{cartService;userService;orderService;router;user=null;cart={items:[],totalPrice:0};orderData={fullName:"",address:"",city:"",postalCode:""};constructor(o,r,t,s){this.cartService=o,this.userService=r,this.orderService=t,this.router=s}ngOnInit(){this.userService.currentUser$.subscribe(o=>{o&&(this.user=o,this.cartService.getCart(o.id).subscribe(r=>{this.cart=r}))})}placeOrder(){if(!this.user||!this.user.id)return void alert("You must be logged in!");if(!(this.orderData.fullName&&this.orderData.address&&this.orderData.city&&this.orderData.postalCode))return void alert("Please fill all fields!");const o={userId:this.user.id,totalPrice:this.cart.totalPrice,items:this.cart.items.map(r=>({productId:r.productId,quantity:r.quantity,size:r.size,color:r.color,price:r.price}))};this.orderService.placeOrder(o).subscribe({next:()=>{this.cartService.clearCart(this.user.id).subscribe(()=>{this.cartService.setCartCount(0)}),this.router.navigate(["/order-success"])},error:r=>{console.log("ORDER ERROR:",r),alert("Something went wrong creating your order.")}})}static \u0275fac=function(r){return new(r||i)(e.rXU(u.m),e.rXU(p.D),e.rXU(m.Q),e.rXU(g.Ix))};static \u0275cmp=e.VBU({type:i,selectors:[["app-checkout"]],decls:22,vars:6,consts:[[1,"checkout-wrapper"],[1,"checkout-box"],["type","text","placeholder","Full Name",3,"ngModelChange","ngModel"],["type","text","placeholder","Address",3,"ngModelChange","ngModel"],["type","text","placeholder","City",3,"ngModelChange","ngModel"],["type","text","placeholder","Postal Code",3,"ngModelChange","ngModel"],[1,"order-summary"],["class","summary-item",4,"ngFor","ngForOf"],[1,"summary-total"],[1,"btn-place-order",3,"click"],[1,"summary-item"],[3,"src"]],template:function(r,t){1&r&&(e.j41(0,"div",0)(1,"h2"),e.EFF(2,"Checkout"),e.k0s(),e.j41(3,"div",1)(4,"h3"),e.EFF(5,"Shipping Information"),e.k0s(),e.j41(6,"input",2),e.mxI("ngModelChange",function(n){return e.DH7(t.orderData.fullName,n)||(t.orderData.fullName=n),n}),e.k0s(),e.j41(7,"input",3),e.mxI("ngModelChange",function(n){return e.DH7(t.orderData.address,n)||(t.orderData.address=n),n}),e.k0s(),e.j41(8,"input",4),e.mxI("ngModelChange",function(n){return e.DH7(t.orderData.city,n)||(t.orderData.city=n),n}),e.k0s(),e.j41(9,"input",5),e.mxI("ngModelChange",function(n){return e.DH7(t.orderData.postalCode,n)||(t.orderData.postalCode=n),n}),e.k0s()(),e.j41(10,"div",6)(11,"h3"),e.EFF(12,"Order Summary"),e.k0s(),e.DNE(13,h,9,4,"div",7),e.nrm(14,"hr"),e.j41(15,"div",8)(16,"span"),e.EFF(17,"Total:"),e.k0s(),e.j41(18,"b"),e.EFF(19),e.k0s()()(),e.j41(20,"button",9),e.bIt("click",function(){return t.placeOrder()}),e.EFF(21,"Place Order"),e.k0s()()),2&r&&(e.R7$(6),e.R50("ngModel",t.orderData.fullName),e.R7$(),e.R50("ngModel",t.orderData.address),e.R7$(),e.R50("ngModel",t.orderData.city),e.R7$(),e.R50("ngModel",t.orderData.postalCode),e.R7$(4),e.Y8G("ngForOf",t.cart.items),e.R7$(6),e.SpI("\u20ac",t.cart.totalPrice,""))},dependencies:[l.MD,l.Sq,d.YN,d.me,d.BC,d.vS],styles:[".checkout-wrapper[_ngcontent-%COMP%]{max-width:900px;margin:50px auto}.checkout-box[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:10px;box-shadow:0 2px 10px #0000000d;margin-bottom:30px}.checkout-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px;margin-bottom:12px;border-radius:6px;border:1px solid #ddd}.order-summary[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:10px;box-shadow:0 2px 10px #0000000d}.summary-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}.summary-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px;border-radius:6px}.summary-total[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:18px;padding:10px 0}.btn-place-order[_ngcontent-%COMP%]{margin-top:25px;width:100%;padding:15px;border:none;background:#111;color:#fff;font-size:18px;border-radius:8px;cursor:pointer}.btn-place-order[_ngcontent-%COMP%]:hover{background:#333}"]})}return i})()}}]);