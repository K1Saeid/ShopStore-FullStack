import{a as D}from"./chunk-G6NDKQ7T.js";import{a as I}from"./chunk-CW247XOG.js";import{a as E}from"./chunk-KLE6COJF.js";import{b as k,c as w,f as O,n as P}from"./chunk-CPA4YIA4.js";import{d as x}from"./chunk-RYH6ERY7.js";import"./chunk-7VWXCVTQ.js";import{h as S,l as M}from"./chunk-NPH7NEJF.js";import{$a as _,Ba as s,Fa as y,Ka as v,Qa as h,Ta as i,Ua as n,Va as C,jb as d,kb as b,lb as g,ob as p,pb as m,qb as u,sa as f,wa as o}from"./chunk-3ZPPO4HR.js";import"./chunk-2VMXMS7J.js";function N(l,a){if(l&1&&(i(0,"div",10),C(1,"img",11),i(2,"div")(3,"p"),d(4),n(),i(5,"small"),d(6),n()(),i(7,"b"),d(8),n()()),l&2){let e=a.$implicit;o(),h("src",e.product.imageUrl,f),o(3),b(e.product.name),o(2),g("Qty: ",e.quantity,""),o(2),g("\u20AC",e.price*e.quantity,"")}}var W=class l{constructor(a,e,t,c){this.cartService=a;this.userService=e;this.orderService=t;this.router=c}user=null;cart={items:[],totalPrice:0};orderData={fullName:"",address:"",city:"",postalCode:""};ngOnInit(){this.userService.currentUser$.subscribe(a=>{a&&(this.user=a,this.cartService.getCart(a.id).subscribe(e=>{this.cart=e}))})}placeOrder(){if(!this.user||!this.user.id){alert("You must be logged in!");return}if(!this.orderData.fullName||!this.orderData.address||!this.orderData.city||!this.orderData.postalCode){alert("Please fill all fields!");return}let a={userId:this.user.id,totalPrice:this.cart.totalPrice,items:this.cart.items.map(e=>({productId:e.productId,quantity:e.quantity,size:e.size,color:e.color,price:e.price}))};this.orderService.placeOrder(a).subscribe({next:()=>{this.cartService.clearCart(this.user.id).subscribe(()=>{this.cartService.setCartCount(0)}),this.router.navigate(["/order-success"])},error:e=>{console.log("ORDER ERROR:",e),alert("Something went wrong creating your order.")}})}static \u0275fac=function(e){return new(e||l)(s(D),s(E),s(I),s(x))};static \u0275cmp=y({type:l,selectors:[["app-checkout"]],decls:22,vars:6,consts:[[1,"checkout-wrapper"],[1,"checkout-box"],["type","text","placeholder","Full Name",3,"ngModelChange","ngModel"],["type","text","placeholder","Address",3,"ngModelChange","ngModel"],["type","text","placeholder","City",3,"ngModelChange","ngModel"],["type","text","placeholder","Postal Code",3,"ngModelChange","ngModel"],[1,"order-summary"],["class","summary-item",4,"ngFor","ngForOf"],[1,"summary-total"],[1,"btn-place-order",3,"click"],[1,"summary-item"],[3,"src"]],template:function(e,t){e&1&&(i(0,"div",0)(1,"h2"),d(2,"Checkout"),n(),i(3,"div",1)(4,"h3"),d(5,"Shipping Information"),n(),i(6,"input",2),u("ngModelChange",function(r){return m(t.orderData.fullName,r)||(t.orderData.fullName=r),r}),n(),i(7,"input",3),u("ngModelChange",function(r){return m(t.orderData.address,r)||(t.orderData.address=r),r}),n(),i(8,"input",4),u("ngModelChange",function(r){return m(t.orderData.city,r)||(t.orderData.city=r),r}),n(),i(9,"input",5),u("ngModelChange",function(r){return m(t.orderData.postalCode,r)||(t.orderData.postalCode=r),r}),n()(),i(10,"div",6)(11,"h3"),d(12,"Order Summary"),n(),v(13,N,9,4,"div",7),C(14,"hr"),i(15,"div",8)(16,"span"),d(17,"Total:"),n(),i(18,"b"),d(19),n()()(),i(20,"button",9),_("click",function(){return t.placeOrder()}),d(21,"Place Order"),n()()),e&2&&(o(6),p("ngModel",t.orderData.fullName),o(),p("ngModel",t.orderData.address),o(),p("ngModel",t.orderData.city),o(),p("ngModel",t.orderData.postalCode),o(4),h("ngForOf",t.cart.items),o(6),g("\u20AC",t.cart.totalPrice,""))},dependencies:[M,S,P,k,w,O],styles:[".checkout-wrapper[_ngcontent-%COMP%]{max-width:900px;margin:50px auto}.checkout-box[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:10px;box-shadow:0 2px 10px #0000000d;margin-bottom:30px}.checkout-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px;margin-bottom:12px;border-radius:6px;border:1px solid #ddd}.order-summary[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:10px;box-shadow:0 2px 10px #0000000d}.summary-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}.summary-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px;border-radius:6px}.summary-total[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:18px;padding:10px 0}.btn-place-order[_ngcontent-%COMP%]{margin-top:25px;width:100%;padding:15px;border:none;background:#111;color:#fff;font-size:18px;border-radius:8px;cursor:pointer}.btn-place-order[_ngcontent-%COMP%]:hover{background:#333}"]})};export{W as CheckoutComponent};
