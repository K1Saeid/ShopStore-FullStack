import './polyfills.server.mjs';
import{a as U}from"./chunk-VPDV2SX5.mjs";import{a as j}from"./chunk-JA5OA5QV.mjs";import{a as q}from"./chunk-YX6I325E.mjs";import{a as R}from"./chunk-WDHLO3IG.mjs";import{e as T,i as L}from"./chunk-EY6CEKKC.mjs";import"./chunk-YUFWBB53.mjs";import{b as z,c as W,f as N,n as B}from"./chunk-25CODJY3.mjs";import{j as D,k as V,m as A,n as F}from"./chunk-GDXHRO5M.mjs";import{$a as E,Aa as a,Bb as P,Cb as O,Db as S,Fa as h,Ja as k,Oa as f,Wa as u,Z as p,Za as i,_ as m,_a as n,cb as x,fb as g,gb as l,ob as y,pb as r,qb as M,rb as _,tb as I,ub as C,vb as b,wb as v,zb as w}from"./chunk-LEXWQGSC.mjs";import"./chunk-S6KH3LOX.mjs";var G=d=>["/admin/orders",d],H=d=>({from:"customer",customerId:d});function J(d,o){d&1&&(i(0,"div"),r(1,"Loading..."),n())}function K(d,o){if(d&1&&(i(0,"div"),r(1),n()),d&2){let e=l();a(),M(e.error)}}function Q(d,o){if(d&1){let e=x();i(0,"div",18)(1,"p",19)(2,"strong"),r(3),n()(),i(4,"p",20),r(5),n(),i(6,"div",21)(7,"button",22),g("click",function(){let t=p(e).$implicit,c=l(3);return m(c.startEdit(t))}),r(8,"Edit"),n(),i(9,"button",23),g("click",function(){let t=p(e).$implicit,c=l(3);return m(c.openDeleteModal(t.id))}),r(10,"Delete"),n()()()}if(d&2){let e=o.$implicit;a(3),M(e.addressLine),a(2),I("",e.city," - ",e.province," - ",e.postalCode,"")}}function X(d,o){if(d&1&&(i(0,"div"),f(1,Q,11,4,"div",17),n()),d&2){let e=l(2);a(),u("ngForOf",e.addresses)}}function Z(d,o){d&1&&(i(0,"p",24),r(1,"No addresses found."),n())}function $(d,o){if(d&1&&(i(0,"div",26)(1,"div",27)(2,"strong"),r(3),n(),i(4,"span",28),r(5),n()(),i(6,"div",29)(7,"p")(8,"strong"),r(9,"Date:"),n(),r(10),P(11,"date"),n(),i(12,"p")(13,"strong"),r(14,"Total:"),n(),r(15),n()()()),d&2){let e=o.$implicit,s=l(3);u("routerLink",w(9,G,e.id))("queryParams",w(11,H,s.customer.id)),a(3),_("Order #",e.id,""),a(2),M(e.status),a(5),_(" ",O(11,6,e.createdAt,"medium"),""),a(5),_(" \u20AC ",e.totalPrice,"")}}function ee(d,o){if(d&1&&(i(0,"div"),f(1,$,16,13,"div",25),n()),d&2){let e=l(2);a(),u("ngForOf",e.paginatedOrders)}}function te(d,o){d&1&&(i(0,"p",24),r(1,"No orders found."),n())}function ne(d,o){if(d&1){let e=x();i(0,"div",7)(1,"div",8)(2,"div",9)(3,"h3",10),r(4,"Personal Info"),n(),i(5,"div",11)(6,"strong"),r(7,"Full Name:"),n(),r(8),n(),i(9,"div",11)(10,"strong"),r(11,"Email:"),n(),r(12),n(),i(13,"div",11)(14,"strong"),r(15,"Phone:"),n(),r(16),n(),i(17,"div",11)(18,"strong"),r(19,"Registered:"),n(),r(20),P(21,"date"),n(),i(22,"div",11)(23,"strong"),r(24,"Last Login:"),n(),r(25),P(26,"date"),n(),i(27,"div",11)(28,"strong"),r(29,"Status:"),n(),r(30),n(),i(31,"div",11)(32,"strong"),r(33,"Role:"),n(),r(34),n()(),i(35,"div",9)(36,"div",12)(37,"h3",10),r(38,"Addresses"),n(),i(39,"button",13),g("click",function(){p(e);let t=l();return m(t.openAddModal())}),r(40,"+ Add"),n()(),f(41,X,2,1,"div",14)(42,Z,2,0,"ng-template",null,0,S),n()(),i(44,"div",15)(45,"div",9)(46,"h3",10),r(47,"Orders"),n(),f(48,ee,2,1,"div",14)(49,te,2,0,"ng-template",null,1,S),n(),i(51,"app-pagination",16),v("currentPageChange",function(t){p(e);let c=l();return b(c.ordersPage,t)||(c.ordersPage=t),m(t)}),n(),E(52,"p"),n()()}if(d&2){let e=y(43),s=y(50),t=l();a(8),_(" ",t.customer.fullName,""),a(4),_(" ",t.customer.email,""),a(4),_(" ",t.customer.phone||"-",""),a(4),_(" ",O(21,14,t.customer.createdAt,"medium"),""),a(5),_(" ",t.customer.lastLoginAt?O(26,17,t.customer.lastLoginAt,"medium"):"Never",""),a(5),_(" ",t.customer.status,""),a(4),_(" ",t.customer.role,""),a(7),u("ngIf",t.addresses.length>0)("ngIfElse",e),a(7),u("ngIf",t.orders.length>0)("ngIfElse",s),a(3),u("totalItems",t.orders.length)("pageSize",t.ordersPageSize),C("currentPage",t.ordersPage)}}function ie(d,o){if(d&1){let e=x();i(0,"div",30),g("click",function(){p(e);let t=l();return m(t.closeModal())}),n()}}function oe(d,o){if(d&1){let e=x();i(0,"div",31)(1,"div",32),g("click",function(t){return p(e),m(t.stopPropagation())}),i(2,"h3"),r(3),n(),i(4,"input",33),v("ngModelChange",function(t){p(e);let c=l();return b(c.addressForm.addressLine,t)||(c.addressForm.addressLine=t),m(t)}),n(),i(5,"input",34),v("ngModelChange",function(t){p(e);let c=l();return b(c.addressForm.city,t)||(c.addressForm.city=t),m(t)}),n(),i(6,"input",35),v("ngModelChange",function(t){p(e);let c=l();return b(c.addressForm.province,t)||(c.addressForm.province=t),m(t)}),n(),i(7,"input",36),v("ngModelChange",function(t){p(e);let c=l();return b(c.addressForm.postalCode,t)||(c.addressForm.postalCode=t),m(t)}),n(),i(8,"div",37)(9,"button",38),g("click",function(){p(e);let t=l();return m(t.saveAddress())}),r(10),n(),i(11,"button",39),g("click",function(){p(e);let t=l();return m(t.closeModal())}),r(12,"Cancel"),n()()()()}if(d&2){let e=l();a(3),M(e.isEditing?"Edit Address":"Add New Address"),a(),C("ngModel",e.addressForm.addressLine),a(),C("ngModel",e.addressForm.city),a(),C("ngModel",e.addressForm.province),a(),C("ngModel",e.addressForm.postalCode),a(3),_(" ",e.isEditing?"Save Changes":"Add Address"," ")}}function re(d,o){if(d&1){let e=x();i(0,"div",30),g("click",function(){p(e);let t=l();return m(t.closeDeleteModal())}),n()}}function de(d,o){if(d&1){let e=x();i(0,"div",31)(1,"div",40),g("click",function(t){return p(e),m(t.stopPropagation())}),i(2,"h3"),r(3,"Delete Address?"),n(),i(4,"p"),r(5,"Are you sure you want to delete this address?"),n(),i(6,"div",37)(7,"button",41),g("click",function(){p(e);let t=l();return m(t.confirmDelete())}),r(8,"Delete"),n(),i(9,"button",39),g("click",function(){p(e);let t=l();return m(t.closeDeleteModal())}),r(10,"Cancel"),n()()()()}}var Y=class d{constructor(o,e,s,t){this.route=o;this.userService=e;this.addressService=s;this.orderService=t}ordersPage=1;ordersPageSize=5;customer=null;loading=!0;error="";addresses=[];orders=[];isEditing=!1;editId=null;addressForm={addressLine:"",city:"",province:"",postalCode:""};modalOpen=!1;deleteModalOpen=!1;deleteId=null;ngOnInit(){let o=this.route.snapshot.paramMap.get("id");o&&this.loadCustomer(+o)}loadCustomer(o){this.userService.getUserById(o).subscribe(e=>{this.customer=e,this.addressService.getByUserId(o).subscribe(s=>{this.addresses=s}),this.orderService.getOrdersByCustomer(o).subscribe(s=>{this.orders=s}),this.loading=!1})}cancelEdit(){this.isEditing=!1,this.editId=null,this.addressForm={addressLine:"",city:"",province:"",postalCode:""}}deleteAddress(o){confirm("Are you sure you want to delete this address?")&&this.addressService.deleteAddress(o).subscribe(()=>{this.addresses=this.addresses.filter(e=>e.id!==o)})}openAddModal(){this.isEditing=!1,this.editId=null,this.addressForm={addressLine:"",city:"",province:"",postalCode:""},this.modalOpen=!0}startEdit(o){this.isEditing=!0,this.editId=o.id,this.addressForm={addressLine:o.addressLine,city:o.city,province:o.province,postalCode:o.postalCode},this.modalOpen=!0}closeModal(){this.modalOpen=!1}saveAddress(){if(!this.addressForm.addressLine.trim())return;let o={addressLine:this.addressForm.addressLine,city:this.addressForm.city,province:this.addressForm.province,postalCode:this.addressForm.postalCode,isDefault:!1};this.isEditing&&this.editId?this.addressService.updateAddress(this.editId,o).subscribe(()=>{this.loadCustomer(this.customer.id),this.closeModal()}):this.addressService.addAddress(this.customer.id,o).subscribe(()=>{this.loadCustomer(this.customer.id),this.closeModal()})}openDeleteModal(o){this.deleteId=o,this.deleteModalOpen=!0}closeDeleteModal(){this.deleteModalOpen=!1,this.deleteId=null}confirmDelete(){this.deleteId&&this.addressService.deleteAddress(this.deleteId).subscribe(()=>{this.loadCustomer(this.customer.id),this.closeDeleteModal()})}get paginatedOrders(){let o=(this.ordersPage-1)*this.ordersPageSize;return this.orders.slice(o,o+this.ordersPageSize)}static \u0275fac=function(e){return new(e||d)(h(T),h(R),h(U),h(q))};static \u0275cmp=k({type:d,selectors:[["app-customer-details"]],decls:9,vars:7,consts:[["noAddress",""],["noOrders",""],[1,"page-title"],[4,"ngIf"],["class","details-wrapper",4,"ngIf"],["class","modal-backdrop",3,"click",4,"ngIf"],["class","modal",4,"ngIf"],[1,"details-wrapper"],[1,"left-column"],[1,"card"],[1,"section-title"],[1,"info-row"],[1,"flex-between"],[1,"btn-add",3,"click"],[4,"ngIf","ngIfElse"],[1,"right-column"],[3,"currentPageChange","totalItems","pageSize","currentPage"],["class","address-item",4,"ngFor","ngForOf"],[1,"address-item"],[1,"addr-line"],[1,"addr-sub"],[1,"addr-actions"],[1,"btn-mini","edit",3,"click"],[1,"btn-mini","delete",3,"click"],[1,"empty"],["class","order-box clickable",3,"routerLink","queryParams",4,"ngFor","ngForOf"],[1,"order-box","clickable",3,"routerLink","queryParams"],[1,"order-header"],[1,"order-status"],[1,"order-body"],[1,"modal-backdrop",3,"click"],[1,"modal"],[1,"modal-content",3,"click"],["placeholder","Address",1,"input",3,"ngModelChange","ngModel"],["placeholder","City",1,"input",3,"ngModelChange","ngModel"],["placeholder","Province",1,"input",3,"ngModelChange","ngModel"],["placeholder","Postal Code",1,"input",3,"ngModelChange","ngModel"],[1,"modal-actions"],[1,"btn","btn-dark",3,"click"],[1,"btn","btn-cancel",3,"click"],[1,"modal-content","delete-modal",3,"click"],[1,"btn","btn-delete",3,"click"]],template:function(e,s){e&1&&(i(0,"h2",2),r(1,"Customer Details"),n(),f(2,J,2,0,"div",3)(3,K,2,1,"div",3)(4,ne,53,20,"div",4)(5,ie,1,0,"div",5)(6,oe,13,6,"div",6)(7,re,1,0,"div",5)(8,de,11,0,"div",6)),e&2&&(a(2),u("ngIf",s.loading),a(),u("ngIf",s.error),a(),u("ngIf",!s.loading&&s.customer),a(),u("ngIf",s.modalOpen),a(),u("ngIf",s.modalOpen),a(),u("ngIf",s.deleteModalOpen),a(),u("ngIf",s.deleteModalOpen))},dependencies:[F,D,V,A,B,z,W,N,j,L],styles:[".details-box[_ngcontent-%COMP%]{background:#fff;padding:25px;border-radius:12px;box-shadow:0 2px 12px #00000012;max-width:600px}.section[_ngcontent-%COMP%]{margin-bottom:20px}.section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:12px;font-size:20px}.info-row[_ngcontent-%COMP%]{font-size:15px;margin-bottom:8px}.address-box[_ngcontent-%COMP%], .order-box[_ngcontent-%COMP%]{background:#f7f7f7;padding:12px;border-radius:8px;margin-bottom:10px;cursor:pointer;transition:all .5s ease-out}.address-box[_ngcontent-%COMP%], .order-box[_ngcontent-%COMP%]:hover{background-color:#fff;color:#333;border:1px solid #007bff}.default-label[_ngcontent-%COMP%]{font-size:12px;color:green;font-weight:700}.empty[_ngcontent-%COMP%]{color:#777;font-style:italic}.btn-back[_ngcontent-%COMP%]{padding:8px 16px;background:#444;color:#fff;border-radius:6px;cursor:pointer;border:none}.address-box[_ngcontent-%COMP%]{background:#f7f7f7;padding:12px;border-radius:8px;margin-bottom:10px}.btn-small[_ngcontent-%COMP%]{font-size:12px;padding:4px 8px;border:none;border-radius:5px;cursor:pointer;margin-right:6px}.btn-small.edit[_ngcontent-%COMP%]{background:#007bff;color:#fff}.btn-small.delete[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.form-box[_ngcontent-%COMP%]{margin-top:15px}.input[_ngcontent-%COMP%]{width:100%;padding:8px;margin-bottom:8px;border-radius:6px;border:1px solid #ccc}.btn-save[_ngcontent-%COMP%]{background:#000;color:#fff;padding:10px;border-radius:8px;width:100%;margin-bottom:10px}.btn-cancel[_ngcontent-%COMP%]{background:#777;color:#fff;padding:8px;border-radius:8px;width:100%}.modal-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:22px;font-weight:600;margin-bottom:18px}.modal-actions[_ngcontent-%COMP%]{margin-top:18px;display:flex;gap:12px}.input[_ngcontent-%COMP%]{width:100%;padding:11px 12px;margin-bottom:12px;border-radius:8px;border:1px solid #d5d5d5;font-size:14px;transition:.2s}.input[_ngcontent-%COMP%]:focus{border-color:#000;box-shadow:0 0 0 3px #2563eb33;outline:none}.btn-delete[_ngcontent-%COMP%]{flex:1;background:#dc3545;color:#fff;padding:10px;border-radius:8px}.btn-cancel[_ngcontent-%COMP%]{flex:1;background:#777;color:#fff}.btn-add-address[_ngcontent-%COMP%]{background:#111;color:#fff;padding:8px 14px;border-radius:6px;border:none;cursor:pointer;margin-bottom:12px;transition:.2s}.btn-add-address[_ngcontent-%COMP%]:hover{background:#333}.btn-small.edit[_ngcontent-%COMP%]{background:#007bff;color:#fff;font-size:13px;border-radius:5px;border:none;cursor:pointer}.btn-small.edit[_ngcontent-%COMP%]:hover{background:#006ad1}@keyframes _ngcontent-%COMP%_fadeIn{to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}.page-title[_ngcontent-%COMP%]{font-size:28px;font-weight:700;margin-bottom:25px}.details-wrapper[_ngcontent-%COMP%]{display:flex;gap:30px}.left-column[_ngcontent-%COMP%]{width:40%}.right-column[_ngcontent-%COMP%]{width:60%}.card[_ngcontent-%COMP%]{background:#fff;padding:25px;border-radius:14px;box-shadow:0 5px 18px #0000000f;margin-bottom:25px;border:1px solid #f1f1f1}.section-title[_ngcontent-%COMP%]{font-size:20px;margin-bottom:15px;font-weight:600}.info-row[_ngcontent-%COMP%]{font-size:15px;margin-bottom:10px}.address-item[_ngcontent-%COMP%]{background:#f9f9f9;padding:14px;border-radius:8px;border:1px solid #ececec;margin-bottom:12px}.addr-line[_ngcontent-%COMP%]{font-size:15px}.addr-sub[_ngcontent-%COMP%]{font-size:13px;color:#666}.addr-actions[_ngcontent-%COMP%]{margin-top:10px;display:flex;gap:8px}.btn-mini[_ngcontent-%COMP%]{padding:5px 10px;font-size:12px;border-radius:6px;border:none;cursor:pointer}.btn-mini.edit[_ngcontent-%COMP%]{background:#0069ff;color:#fff}.btn-mini.delete[_ngcontent-%COMP%]{background:#d62828;color:#fff}.btn-add[_ngcontent-%COMP%]{padding:6px 12px;background:#111;color:#fff;border-radius:6px;border:none;cursor:pointer;font-size:14px}.flex-between[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.order-card[_ngcontent-%COMP%]{background:#fdfdfd;border:1px solid #eaeaea;padding:18px;border-radius:10px;margin-bottom:14px;transition:.2s}.order-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 6px 16px #00000014}.order-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:10px}.order-status[_ngcontent-%COMP%]{background:#111;color:#fff;padding:4px 10px;border-radius:8px;font-size:12px}.empty[_ngcontent-%COMP%]{color:#888;font-style:italic}.modal-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000073;backdrop-filter:blur(2px);z-index:1000}.modal[_ngcontent-%COMP%]{position:fixed;inset:0;display:flex;justify-content:center;align-items:center;z-index:1001;animation:_ngcontent-%COMP%_fadeIn .25s}.modal-content[_ngcontent-%COMP%]{background:#fff;padding:28px;width:420px;border-radius:14px;box-shadow:0 15px 35px #00000026;animation:_ngcontent-%COMP%_slideUp .3s ease}.btn-delete[_ngcontent-%COMP%]{background:#d62828;color:#fff}.btn-cancel[_ngcontent-%COMP%]{background:#777;color:#fff}"]})};export{Y as CustomerDetailsComponent};
