"use strict";(self.webpackChunkshop_web=self.webpackChunkshop_web||[]).push([[578],{3578:(T,l,i)=>{i.r(l),i.d(l,{CustomerDetailsComponent:()=>y});var a=i(2881),p=i(9870),c=i(4341),_=i(262),e=i(1360),m=i(9315),u=i(4796),g=i(6962),f=i(8674);const C=o=>["/admin/orders",o],b=o=>({from:"customer",customerId:o});function x(o,d){1&o&&(e.j41(0,"div"),e.EFF(1,"Loading..."),e.k0s())}function h(o,d){if(1&o&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&o){const t=e.XpG();e.R7$(),e.JRh(t.error)}}function v(o,d){if(1&o){const t=e.RV6();e.j41(0,"div",18)(1,"p",19)(2,"strong"),e.EFF(3),e.k0s()(),e.j41(4,"p",20),e.EFF(5),e.k0s(),e.j41(6,"div",21)(7,"button",22),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(3);return e.Njj(r.startEdit(n))}),e.EFF(8,"Edit"),e.k0s(),e.j41(9,"button",23),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(3);return e.Njj(r.openDeleteModal(n.id))}),e.EFF(10,"Delete"),e.k0s()()()}if(2&o){const t=d.$implicit;e.R7$(3),e.JRh(t.addressLine),e.R7$(2),e.E5c("",t.city," - ",t.province," - ",t.postalCode,"")}}function M(o,d){if(1&o&&(e.j41(0,"div"),e.DNE(1,v,11,4,"div",17),e.k0s()),2&o){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.addresses)}}function k(o,d){1&o&&(e.j41(0,"p",24),e.EFF(1,"No addresses found."),e.k0s())}function F(o,d){if(1&o&&(e.j41(0,"div",26)(1,"div",27)(2,"strong"),e.EFF(3),e.k0s(),e.j41(4,"span",28),e.EFF(5),e.k0s()(),e.j41(6,"div",29)(7,"p")(8,"strong"),e.EFF(9,"Date:"),e.k0s(),e.EFF(10),e.nI1(11,"date"),e.k0s(),e.j41(12,"p")(13,"strong"),e.EFF(14,"Total:"),e.k0s(),e.EFF(15),e.k0s()()()),2&o){const t=d.$implicit,s=e.XpG(3);e.Y8G("routerLink",e.eq3(9,C,t.id))("queryParams",e.eq3(11,b,s.customer.id)),e.R7$(3),e.SpI("Order #",t.id,""),e.R7$(2),e.JRh(t.status),e.R7$(5),e.SpI(" ",e.i5U(11,6,t.createdAt,"medium"),""),e.R7$(5),e.SpI(" \u20ac ",t.totalPrice,"")}}function P(o,d){if(1&o&&(e.j41(0,"div"),e.DNE(1,F,16,13,"div",25),e.k0s()),2&o){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.paginatedOrders)}}function O(o,d){1&o&&(e.j41(0,"p",24),e.EFF(1,"No orders found."),e.k0s())}function E(o,d){if(1&o){const t=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"div",9)(3,"h3",10),e.EFF(4,"Personal Info"),e.k0s(),e.j41(5,"div",11)(6,"strong"),e.EFF(7,"Full Name:"),e.k0s(),e.EFF(8),e.k0s(),e.j41(9,"div",11)(10,"strong"),e.EFF(11,"Email:"),e.k0s(),e.EFF(12),e.k0s(),e.j41(13,"div",11)(14,"strong"),e.EFF(15,"Phone:"),e.k0s(),e.EFF(16),e.k0s(),e.j41(17,"div",11)(18,"strong"),e.EFF(19,"Registered:"),e.k0s(),e.EFF(20),e.nI1(21,"date"),e.k0s(),e.j41(22,"div",11)(23,"strong"),e.EFF(24,"Last Login:"),e.k0s(),e.EFF(25),e.nI1(26,"date"),e.k0s(),e.j41(27,"div",11)(28,"strong"),e.EFF(29,"Status:"),e.k0s(),e.EFF(30),e.k0s(),e.j41(31,"div",11)(32,"strong"),e.EFF(33,"Role:"),e.k0s(),e.EFF(34),e.k0s()(),e.j41(35,"div",9)(36,"div",12)(37,"h3",10),e.EFF(38,"Addresses"),e.k0s(),e.j41(39,"button",13),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.openAddModal())}),e.EFF(40,"+ Add"),e.k0s()(),e.DNE(41,M,2,1,"div",14)(42,k,2,0,"ng-template",null,0,e.C5r),e.k0s()(),e.j41(44,"div",15)(45,"div",9)(46,"h3",10),e.EFF(47,"Orders"),e.k0s(),e.DNE(48,P,2,1,"div",14)(49,O,2,0,"ng-template",null,1,e.C5r),e.k0s(),e.j41(51,"app-pagination",16),e.mxI("currentPageChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.ordersPage,n)||(r.ordersPage=n),e.Njj(n)}),e.k0s(),e.nrm(52,"p"),e.k0s()()}if(2&o){const t=e.sdS(43),s=e.sdS(50),n=e.XpG();e.R7$(8),e.SpI(" ",n.customer.fullName,""),e.R7$(4),e.SpI(" ",n.customer.email,""),e.R7$(4),e.SpI(" ",n.customer.phone||"-",""),e.R7$(4),e.SpI(" ",e.i5U(21,14,n.customer.createdAt,"medium"),""),e.R7$(5),e.SpI(" ",n.customer.lastLoginAt?e.i5U(26,17,n.customer.lastLoginAt,"medium"):"Never",""),e.R7$(5),e.SpI(" ",n.customer.status,""),e.R7$(4),e.SpI(" ",n.customer.role,""),e.R7$(7),e.Y8G("ngIf",n.addresses.length>0)("ngIfElse",t),e.R7$(7),e.Y8G("ngIf",n.orders.length>0)("ngIfElse",s),e.R7$(3),e.Y8G("totalItems",n.orders.length)("pageSize",n.ordersPageSize),e.R50("currentPage",n.ordersPage)}}function j(o,d){if(1&o){const t=e.RV6();e.j41(0,"div",30),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closeModal())}),e.k0s()}}function D(o,d){if(1&o){const t=e.RV6();e.j41(0,"div",31)(1,"div",32),e.bIt("click",function(n){return e.eBV(t),e.Njj(n.stopPropagation())}),e.j41(2,"h3"),e.EFF(3),e.k0s(),e.j41(4,"input",33),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.addressForm.addressLine,n)||(r.addressForm.addressLine=n),e.Njj(n)}),e.k0s(),e.j41(5,"input",34),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.addressForm.city,n)||(r.addressForm.city=n),e.Njj(n)}),e.k0s(),e.j41(6,"input",35),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.addressForm.province,n)||(r.addressForm.province=n),e.Njj(n)}),e.k0s(),e.j41(7,"input",36),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.addressForm.postalCode,n)||(r.addressForm.postalCode=n),e.Njj(n)}),e.k0s(),e.j41(8,"div",37)(9,"button",38),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.saveAddress())}),e.EFF(10),e.k0s(),e.j41(11,"button",39),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closeModal())}),e.EFF(12,"Cancel"),e.k0s()()()()}if(2&o){const t=e.XpG();e.R7$(3),e.JRh(t.isEditing?"Edit Address":"Add New Address"),e.R7$(),e.R50("ngModel",t.addressForm.addressLine),e.R7$(),e.R50("ngModel",t.addressForm.city),e.R7$(),e.R50("ngModel",t.addressForm.province),e.R7$(),e.R50("ngModel",t.addressForm.postalCode),e.R7$(3),e.SpI(" ",t.isEditing?"Save Changes":"Add Address"," ")}}function I(o,d){if(1&o){const t=e.RV6();e.j41(0,"div",30),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closeDeleteModal())}),e.k0s()}}function R(o,d){if(1&o){const t=e.RV6();e.j41(0,"div",31)(1,"div",40),e.bIt("click",function(n){return e.eBV(t),e.Njj(n.stopPropagation())}),e.j41(2,"h3"),e.EFF(3,"Delete Address?"),e.k0s(),e.j41(4,"p"),e.EFF(5,"Are you sure you want to delete this address?"),e.k0s(),e.j41(6,"div",37)(7,"button",41),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.confirmDelete())}),e.EFF(8,"Delete"),e.k0s(),e.j41(9,"button",39),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closeDeleteModal())}),e.EFF(10,"Cancel"),e.k0s()()()()}}let y=(()=>{class o{route;userService;addressService;orderService;ordersPage=1;ordersPageSize=5;customer=null;loading=!0;error="";addresses=[];orders=[];isEditing=!1;editId=null;addressForm={addressLine:"",city:"",province:"",postalCode:""};modalOpen=!1;deleteModalOpen=!1;deleteId=null;constructor(t,s,n,r){this.route=t,this.userService=s,this.addressService=n,this.orderService=r}ngOnInit(){const t=this.route.snapshot.paramMap.get("id");t&&this.loadCustomer(+t)}loadCustomer(t){this.userService.getUserById(t).subscribe(s=>{this.customer=s,this.addressService.getByUserId(t).subscribe(n=>{this.addresses=n}),this.orderService.getOrdersByCustomer(t).subscribe(n=>{this.orders=n}),this.loading=!1})}cancelEdit(){this.isEditing=!1,this.editId=null,this.addressForm={addressLine:"",city:"",province:"",postalCode:""}}deleteAddress(t){confirm("Are you sure you want to delete this address?")&&this.addressService.deleteAddress(t).subscribe(()=>{this.addresses=this.addresses.filter(s=>s.id!==t)})}openAddModal(){this.isEditing=!1,this.editId=null,this.addressForm={addressLine:"",city:"",province:"",postalCode:""},this.modalOpen=!0}startEdit(t){this.isEditing=!0,this.editId=t.id,this.addressForm={addressLine:t.addressLine,city:t.city,province:t.province,postalCode:t.postalCode},this.modalOpen=!0}closeModal(){this.modalOpen=!1}saveAddress(){if(!this.addressForm.addressLine.trim())return;const t={addressLine:this.addressForm.addressLine,city:this.addressForm.city,province:this.addressForm.province,postalCode:this.addressForm.postalCode,isDefault:!1};this.isEditing&&this.editId?this.addressService.updateAddress(this.editId,t).subscribe(()=>{this.loadCustomer(this.customer.id),this.closeModal()}):this.addressService.addAddress(this.customer.id,t).subscribe(()=>{this.loadCustomer(this.customer.id),this.closeModal()})}openDeleteModal(t){this.deleteId=t,this.deleteModalOpen=!0}closeDeleteModal(){this.deleteModalOpen=!1,this.deleteId=null}confirmDelete(){this.deleteId&&this.addressService.deleteAddress(this.deleteId).subscribe(()=>{this.loadCustomer(this.customer.id),this.closeDeleteModal()})}get paginatedOrders(){const t=(this.ordersPage-1)*this.ordersPageSize;return this.orders.slice(t,t+this.ordersPageSize)}static \u0275fac=function(s){return new(s||o)(e.rXU(m.nX),e.rXU(u.D),e.rXU(g.E),e.rXU(f.Q))};static \u0275cmp=e.VBU({type:o,selectors:[["app-customer-details"]],decls:9,vars:7,consts:[["noAddress",""],["noOrders",""],[1,"page-title"],[4,"ngIf"],["class","details-wrapper",4,"ngIf"],["class","modal-backdrop",3,"click",4,"ngIf"],["class","modal",4,"ngIf"],[1,"details-wrapper"],[1,"left-column"],[1,"card"],[1,"section-title"],[1,"info-row"],[1,"flex-between"],[1,"btn-add",3,"click"],[4,"ngIf","ngIfElse"],[1,"right-column"],[3,"currentPageChange","totalItems","pageSize","currentPage"],["class","address-item",4,"ngFor","ngForOf"],[1,"address-item"],[1,"addr-line"],[1,"addr-sub"],[1,"addr-actions"],[1,"btn-mini","edit",3,"click"],[1,"btn-mini","delete",3,"click"],[1,"empty"],["class","order-box clickable",3,"routerLink","queryParams",4,"ngFor","ngForOf"],[1,"order-box","clickable",3,"routerLink","queryParams"],[1,"order-header"],[1,"order-status"],[1,"order-body"],[1,"modal-backdrop",3,"click"],[1,"modal"],[1,"modal-content",3,"click"],["placeholder","Address",1,"input",3,"ngModelChange","ngModel"],["placeholder","City",1,"input",3,"ngModelChange","ngModel"],["placeholder","Province",1,"input",3,"ngModelChange","ngModel"],["placeholder","Postal Code",1,"input",3,"ngModelChange","ngModel"],[1,"modal-actions"],[1,"btn","btn-dark",3,"click"],[1,"btn","btn-cancel",3,"click"],[1,"modal-content","delete-modal",3,"click"],[1,"btn","btn-delete",3,"click"]],template:function(s,n){1&s&&(e.j41(0,"h2",2),e.EFF(1,"Customer Details"),e.k0s(),e.DNE(2,x,2,0,"div",3)(3,h,2,1,"div",3)(4,E,53,20,"div",4)(5,j,1,0,"div",5)(6,D,13,6,"div",6)(7,I,1,0,"div",5)(8,R,11,0,"div",6)),2&s&&(e.R7$(2),e.Y8G("ngIf",n.loading),e.R7$(),e.Y8G("ngIf",n.error),e.R7$(),e.Y8G("ngIf",!n.loading&&n.customer),e.R7$(),e.Y8G("ngIf",n.modalOpen),e.R7$(),e.Y8G("ngIf",n.modalOpen),e.R7$(),e.Y8G("ngIf",n.deleteModalOpen),e.R7$(),e.Y8G("ngIf",n.deleteModalOpen))},dependencies:[a.MD,a.Sq,a.bT,a.vh,c.YN,c.me,c.BC,c.vS,_.e,p.Wk],styles:[".details-box[_ngcontent-%COMP%]{background:#fff;padding:25px;border-radius:12px;box-shadow:0 2px 12px #00000012;max-width:600px}.section[_ngcontent-%COMP%]{margin-bottom:20px}.section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:12px;font-size:20px}.info-row[_ngcontent-%COMP%]{font-size:15px;margin-bottom:8px}.address-box[_ngcontent-%COMP%], .order-box[_ngcontent-%COMP%]{background:#f7f7f7;padding:12px;border-radius:8px;margin-bottom:10px;cursor:pointer;transition:all .5s ease-out}.address-box[_ngcontent-%COMP%], .order-box[_ngcontent-%COMP%]:hover{background-color:#fff;color:#333;border:1px solid #007bff}.default-label[_ngcontent-%COMP%]{font-size:12px;color:green;font-weight:700}.empty[_ngcontent-%COMP%]{color:#777;font-style:italic}.btn-back[_ngcontent-%COMP%]{padding:8px 16px;background:#444;color:#fff;border-radius:6px;cursor:pointer;border:none}.address-box[_ngcontent-%COMP%]{background:#f7f7f7;padding:12px;border-radius:8px;margin-bottom:10px}.btn-small[_ngcontent-%COMP%]{font-size:12px;padding:4px 8px;border:none;border-radius:5px;cursor:pointer;margin-right:6px}.btn-small.edit[_ngcontent-%COMP%]{background:#007bff;color:#fff}.btn-small.delete[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.form-box[_ngcontent-%COMP%]{margin-top:15px}.input[_ngcontent-%COMP%]{width:100%;padding:8px;margin-bottom:8px;border-radius:6px;border:1px solid #ccc}.btn-save[_ngcontent-%COMP%]{background:#000;color:#fff;padding:10px;border-radius:8px;width:100%;margin-bottom:10px}.btn-cancel[_ngcontent-%COMP%]{background:#777;color:#fff;padding:8px;border-radius:8px;width:100%}.modal-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:22px;font-weight:600;margin-bottom:18px}.modal-actions[_ngcontent-%COMP%]{margin-top:18px;display:flex;gap:12px}.input[_ngcontent-%COMP%]{width:100%;padding:11px 12px;margin-bottom:12px;border-radius:8px;border:1px solid #d5d5d5;font-size:14px;transition:.2s}.input[_ngcontent-%COMP%]:focus{border-color:#000;box-shadow:0 0 0 3px #2563eb33;outline:none}.btn-delete[_ngcontent-%COMP%]{flex:1;background:#dc3545;color:#fff;padding:10px;border-radius:8px}.btn-cancel[_ngcontent-%COMP%]{flex:1;background:#777;color:#fff}.btn-add-address[_ngcontent-%COMP%]{background:#111;color:#fff;padding:8px 14px;border-radius:6px;border:none;cursor:pointer;margin-bottom:12px;transition:.2s}.btn-add-address[_ngcontent-%COMP%]:hover{background:#333}.btn-small.edit[_ngcontent-%COMP%]{background:#007bff;color:#fff;font-size:13px;border-radius:5px;border:none;cursor:pointer}.btn-small.edit[_ngcontent-%COMP%]:hover{background:#006ad1}@keyframes _ngcontent-%COMP%_fadeIn{to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}.page-title[_ngcontent-%COMP%]{font-size:28px;font-weight:700;margin-bottom:25px}.details-wrapper[_ngcontent-%COMP%]{display:flex;gap:30px}.left-column[_ngcontent-%COMP%]{width:40%}.right-column[_ngcontent-%COMP%]{width:60%}.card[_ngcontent-%COMP%]{background:#fff;padding:25px;border-radius:14px;box-shadow:0 5px 18px #0000000f;margin-bottom:25px;border:1px solid #f1f1f1}.section-title[_ngcontent-%COMP%]{font-size:20px;margin-bottom:15px;font-weight:600}.info-row[_ngcontent-%COMP%]{font-size:15px;margin-bottom:10px}.address-item[_ngcontent-%COMP%]{background:#f9f9f9;padding:14px;border-radius:8px;border:1px solid #ececec;margin-bottom:12px}.addr-line[_ngcontent-%COMP%]{font-size:15px}.addr-sub[_ngcontent-%COMP%]{font-size:13px;color:#666}.addr-actions[_ngcontent-%COMP%]{margin-top:10px;display:flex;gap:8px}.btn-mini[_ngcontent-%COMP%]{padding:5px 10px;font-size:12px;border-radius:6px;border:none;cursor:pointer}.btn-mini.edit[_ngcontent-%COMP%]{background:#0069ff;color:#fff}.btn-mini.delete[_ngcontent-%COMP%]{background:#d62828;color:#fff}.btn-add[_ngcontent-%COMP%]{padding:6px 12px;background:#111;color:#fff;border-radius:6px;border:none;cursor:pointer;font-size:14px}.flex-between[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.order-card[_ngcontent-%COMP%]{background:#fdfdfd;border:1px solid #eaeaea;padding:18px;border-radius:10px;margin-bottom:14px;transition:.2s}.order-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 6px 16px #00000014}.order-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:10px}.order-status[_ngcontent-%COMP%]{background:#111;color:#fff;padding:4px 10px;border-radius:8px;font-size:12px}.empty[_ngcontent-%COMP%]{color:#888;font-style:italic}.modal-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000073;backdrop-filter:blur(2px);z-index:1000}.modal[_ngcontent-%COMP%]{position:fixed;inset:0;display:flex;justify-content:center;align-items:center;z-index:1001;animation:_ngcontent-%COMP%_fadeIn .25s}.modal-content[_ngcontent-%COMP%]{background:#fff;padding:28px;width:420px;border-radius:14px;box-shadow:0 15px 35px #00000026;animation:_ngcontent-%COMP%_slideUp .3s ease}.btn-delete[_ngcontent-%COMP%]{background:#d62828;color:#fff}.btn-cancel[_ngcontent-%COMP%]{background:#777;color:#fff}"]})}return o})()}}]);